{
  "_metadata": {
    "title": "Renovate Configuration",
    "description": "Automated dependency updates with a security-first posture",
    "standards": ["NIST SSDF", "Supply Chain Security"]
  },
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:base",
    ":dependencyDashboard",
    ":semanticCommits",
    ":separateMajorReleases",
    "group:allNonMajor"
  ],

  "timezone": "UTC",
  "schedule": ["before 6am on monday"],

  "assignees": ["{{ TEAM_NAME }}"],
  "reviewers": ["{{ TEAM_NAME }}"],

  "vulnerabilityAlerts": {
    "enabled": true,
    "labels": ["security", "dependencies"]
  },

  "osvVulnerabilityAlerts": true,

  "packageRules": [
    {
      "description": "Auto-merge security patches",
      "matchUpdateTypes": ["patch"],
      "matchCurrentVersion": "!/^0/",
      "matchPackagePatterns": ["*"],
      "excludePackagePatterns": ["eslint", "prettier"],
      "automerge": true,
      "automergeType": "pr",
      "labels": ["dependencies", "security", "automerge"]
    },
    {
      "description": "Security updates get priority",
      "matchDatasources": ["npm"],
      "matchUpdateTypes": ["patch"],
      "labels": ["security", "dependencies"],
      "prPriority": 10,
      "minimumReleaseAge": "0 days"
    },
    {
      "description": "Group all minor and patch updates",
      "matchUpdateTypes": ["minor", "patch"],
      "groupName": "all non-major dependencies",
      "groupSlug": "all-minor-patch"
    },
    {
      "description": "Major updates require manual review",
      "matchUpdateTypes": ["major"],
      "automerge": false,
      "labels": ["dependencies", "major-update"],
      "prPriority": 5,
      "minimumReleaseAge": "7 days",
      "stabilityDays": 7
    },
    {
      "description": "DevDependencies less strict",
      "matchDepTypes": ["devDependencies"],
      "automerge": true,
      "automergeType": "pr",
      "minimumReleaseAge": "3 days"
    },
    {
      "description": "Pin Docker images to specific versions",
      "matchDatasources": ["docker"],
      "matchUpdateTypes": ["major", "minor", "patch"],
      "groupName": "Docker images",
      "automerge": false,
      "pinDigests": true
    },
    {
      "description": "GitHub Actions stay current",
      "matchManagers": ["github-actions"],
      "automerge": true,
      "automergeType": "pr",
      "pinDigests": true,
      "labels": ["github-actions"]
    }
  ],

  "labels": ["dependencies"],

  "prConcurrentLimit": 5,
  "prCreation": "not-pending",
  "prHourlyLimit": 2,

  "commitMessagePrefix": "chore(deps):",
  "commitMessageAction": "update",
  "commitMessageTopic": "{{depName}}",
  "commitMessageExtra": "to {{#if isPinDigest}}{{{newDigestShort}}}{{else}}{{#if isMajor}}{{prettyNewMajor}}{{else}}{{#if isSingleVersion}}{{prettyNewVersion}}{{else}}{{#if newValue}}{{{newValue}}}{{else}}{{{newDigestShort}}}{{/if}}{{/if}}{{/if}}{{/if}}",

  "lockFileMaintenance": {
    "enabled": true,
    "schedule": ["before 6am on monday"],
    "commitMessageAction": "update lockfile",
    "automerge": true,
    "automergeType": "pr"
  },

  "ignoreDeps": ["node", "npm"],

  "prBodyTemplate": "This PR updates dependencies to keep the project secure and up-to-date.\n\n### Changes\n{{{body}}}\n\n### Security\n- ✅ All dependencies scanned for vulnerabilities\n- ✅ SBOM will be regenerated\n- ✅ Signatures will be updated\n\n### Verification\n- [ ] CI checks pass\n- [ ] Security scans clean\n- [ ] No breaking changes\n\n---\n*Automated by Renovate*",

  "prBodyColumns": [
    "Package",
    "Change",
    "Age",
    "Adoption",
    "Passing",
    "Confidence"
  ],

  "prBodyDefinitions": {
    "Age": "[![age](https://developer.mend.io/api/mc/badges/age/{{datasource}}/{{depName}}/{{newVersion}}?slim=true)](https://docs.renovatebot.com/merge-confidence/)",
    "Adoption": "[![adoption](https://developer.mend.io/api/mc/badges/adoption/{{datasource}}/{{depName}}/{{newVersion}}?slim=true)](https://docs.renovatebot.com/merge-confidence/)",
    "Passing": "[![passing](https://developer.mend.io/api/mc/badges/compatibility/{{datasource}}/{{depName}}/{{currentVersion}}/{{newVersion}}?slim=true)](https://docs.renovatebot.com/merge-confidence/)",
    "Confidence": "[![confidence](https://developer.mend.io/api/mc/badges/confidence/{{datasource}}/{{depName}}/{{currentVersion}}/{{newVersion}}?slim=true)](https://docs.renovatebot.com/merge-confidence/)"
  },

  "statusCheckVerify": true,

  "bumpVersion": "patch",

  "enabledManagers": [
    "npm",
    "docker-compose",
    "dockerfile",
    "github-actions",
    "terraform",
    "helm-values",
    "kubernetes"
  ],

  "ignorePaths": [
    "**/node_modules/**",
    "**/bower_components/**",
    "**/vendor/**"
  ],

  "postUpdateOptions": ["npmDedupe"],

  "rangeStrategy": "update-lockfile"
}
